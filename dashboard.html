<script>
    document.addEventListener("DOMContentLoaded", function () {
        let loggedInUser = localStorage.getItem("loggedInUser");
        let userType = localStorage.getItem("userType");

        if (!loggedInUser || userType !== "user") {
            window.location.href = "index.html";
        } else {
            document.getElementById("usernameDisplay").textContent = loggedInUser;
        }

        // Example dynamic update for bottles and points
        document.getElementById("bottlesCollected").textContent = 10; // Replace with actual value
        document.getElementById("pointsEarned").textContent = 15;    // Replace with actual value
        document.getElementById("pointsUsed").textContent = 5;       // Replace with actual value

        document.getElementById("logout").addEventListener("click", function () {
            localStorage.removeItem("loggedInUser");
            localStorage.removeItem("userType");
            window.location.href = "index.html";
        });

        // Handle Transfer Points button click
        document.getElementById("transferPoints").addEventListener("click", function () {
            const recipient = document.getElementById("recipientUsername").value;
            const pointsToTransfer = parseInt(document.getElementById("pointsToTransfer").value);

            if (!recipient || isNaN(pointsToTransfer) || pointsToTransfer <= 0) {
                alert("Please enter a valid recipient and a valid number of points to transfer.");
                return;
            }

            // Example logic for transferring points
            // You can replace this with an API call or server interaction
            const userPoints = parseInt(document.getElementById("pointsEarned").textContent);
            if (pointsToTransfer > userPoints) {
                alert("Insufficient points to transfer.");
                return;
            }

            document.getElementById("pointsEarned").textContent = userPoints - pointsToTransfer;
            alert(`Successfully transferred ${pointsToTransfer} points to ${recipient}!`);

            // Optionally, update pointsUsed
            const pointsUsed = parseInt(document.getElementById("pointsUsed").textContent) + pointsToTransfer;
            document.getElementById("pointsUsed").textContent = pointsUsed;

            // Example: send data to server (uncomment to implement)
            /*
            fetch('https://your-server-endpoint/transfer', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    sender: loggedInUser,
                    recipient: recipient,
                    points: pointsToTransfer
                })
            }).then(response => response.json())
              .then(data => {
                  console.log(data);
                  alert('Points transferred successfully!');
              }).catch(error => {
                  console.error('Error:', error);
              });
            */
        });
    });
</script>
