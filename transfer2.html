<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transfer Points</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h2>ReClaimIt</h2>
       <h3>Transfer Points</h3>
            <form id="transferForm">
                <input type="text" id="toUser" placeholder="Recipient Username">
                <input type="number" id="transferAmount" placeholder="Points to Transfer">
                <button type="submit">Transfer</button>
                
    <script>
       document.getElementById('transferForm').addEventListener('submit', async function (event) {
    event.preventDefault();

    const fromUser = localStorage.getItem('currentUser');
    const toUser = document.getElementById('toUser').value;
    const amount = parseInt(document.getElementById('transferAmount').value);

    if (!fromUser || !toUser || isNaN(amount) || amount <= 0) {
        alert("Invalid transfer details!");
        return;
    }

    const fromUserID = getUserID(fromUser);
    const toUserID = getUserID(toUser);

    const fromPointsPin = 11 + (fromUserID * 10);
    const toPointsPin = 11 + (toUserID * 10);

    let fromUserPoints = await fetchBlynkData(fromPointsPin);
    fromUserPoints = parseInt(fromUserPoints);

    if (fromUserPoints < amount) {
        alert("Not enough points!");
        return;
    }

    let toUserPoints = await fetchBlynkData(toPointsPin);
    toUserPoints = parseInt(toUserPoints);

    await updateBlynkData(fromPointsPin, fromUserPoints - amount);
    await updateBlynkData(toPointsPin, toUserPoints + amount);

    alert(`Transferred ${amount} points from ${fromUser} to ${toUser}`);
    loadUserData(fromUser);
});
    </script>
</body>
</html>
