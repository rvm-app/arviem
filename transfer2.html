<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transfer Points</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h2>ReClaimIt</h2>
        <h1>Transfer Points</h1>
        <p><strong>Current Balance:</strong> <span id="balance">0</span> points</p>
        <div class="input-field">
            <label for="sendTo">Send To (Username)</label>
            <input type="text" id="sendTo" placeholder="Enter username or 'Admin'">
        </div>
        <div class="input-field">
            <label for="amount">Amount</label>
            <input type="number" id="amount" placeholder="Enter amount">
        </div>
        <button class="done-btn" onclick="transferPoints()">Transfer</button>
        <p id="message"></p>
        <p><a href="index.html" class="back-link">Back to Dashboard</a></p>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let currentUser = localStorage.getItem("currentUser");
            let users = JSON.parse(localStorage.getItem("users")) || {};
            if (currentUser && users[currentUser]) {
                document.getElementById("balance").textContent = users[currentUser].pointsEarned;
            }
        });

        function transferPoints() {
            let currentUser = localStorage.getItem("currentUser");
            let users = JSON.parse(localStorage.getItem("users")) || {};
            let sendTo = document.getElementById("sendTo").value.trim();
            let amount = parseInt(document.getElementById("amount").value);
            let message = document.getElementById("message");

            if (!sendTo || isNaN(amount) || amount <= 0) {
                message.textContent = "Invalid input. Please enter a valid username and amount.";
                return;
            }

            if (!users[currentUser] || users[currentUser].pointsEarned < amount) {
                message.textContent = "Insufficient points.";
                return;
            }

            if (sendTo === "Admin" || users[sendTo]) {
                users[currentUser].pointsEarned -= amount;
                if (sendTo === "Admin") {
                    users[sendTo] = users[sendTo] || { pointsEarned: 0 };
                }
                users[sendTo].pointsEarned = (users[sendTo].pointsEarned || 0) + amount;
                localStorage.setItem("users", JSON.stringify(users));
                document.getElementById("balance").textContent = users[currentUser].pointsEarned;
                message.textContent = `Successfully transferred ${amount} points to ${sendTo}.`;
            } else {
                message.textContent = "Recipient not found.";
            }
        }
    </script>
</body>
</html>
